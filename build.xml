<?xml version="1.0" encoding="UTF-8"?>
<project name="sarissa" default="dist" basedir=".">
	<description>
	Ant build file for Sarissa project developers (me ;-). 
	More info at http://sarissa.sf.net 
	Email comments at mbatsis@users.sf.net
	</description>
	<property name="project.version" value="0.9.3"/>
    <property name="dist.dir" location="dist"/>
    <property name="doc.dir" location="doc"/>
    <property name="src.dir" location="${basedir}"/>
    <property name="jsdoc.dist.dir" location="build_tools/jsdoc"/>
    <property name="jsdoc.out.dir" location="jsdoc_out"/>
    <target name="init" depends="clean">
        <tstamp/>
    </target>
    <target name="clean" description="Deletes all generated files and directories">
        <delete dir="${dist.dir}"/>
        <delete dir="${jsdoc.out.dir}"/>
    </target>
    <target name="jsdoc" depends="init" description="Generates the JSdoc documentation in jsdoc.out.dir">
    	<!--echo message="${jsdoc.dist.dir}/jsdoc.pl ${src.dir}/sarissa.js -d ${jsdoc.out.dir}"/-->
   		<exec executable="perl" failonerror="true" >
	   		<arg line="${jsdoc.dist.dir}/jsdoc.pl  
	   		                     --private 
	   							--directory ${jsdoc.out.dir} 
	   							--project-name ${ant.project.name} 
	   							--project-summary doc/jsdoc-project-summary 
	   							${src.dir}/sarissa.js ${src.dir}/testsarissa.js"/>
	   	</exec>
    </target>
    <target name="dist" depends="jsdoc" description="Assembles a destribution archive in dist.dir">        
        <mkdir dir="${dist.dir}"/>
        <zip zipfile="${dist.dir}/${ant.project.name}${project.version}.zip">
        	<zipfileset dir="${doc.dir}" prefix="${ant.project.name}/doc" includes="**/*.*" excludes="jsdoc-project-summary"/>
        	<zipfileset dir="${jsdoc.out.dir}" prefix="${ant.project.name}/doc" includes="**/*.*"/>
            <zipfileset dir="${src.dir}" prefix="${ant.project.name}" includes="CHANGELOG.txt"/>   
        	<zipfileset dir="${src.dir}" prefix="${ant.project.name}" includes="sarissa.js"/>
        </zip>
    </target>
</project>